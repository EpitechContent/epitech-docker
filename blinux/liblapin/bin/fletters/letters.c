/*
**
**
**
**
**
*/

#include		<string.h>
#include		"fletters.h"

typedef struct		s_line
{
  int			x0;
  int			y0;
  int			x1;
  int			y1;
}			t_line;

typedef struct
{
  int			cnt;
  t_line		line[5];
}			t_letter_;

/* 20 * 20 */
const t_letter_		gl_letters[26 + 10 + 1] =
  {
    /* a */
    {
      3,
      {
	{00, 20, 10, 00},
	{10, 00, 20, 20},
	{ 5, 10, 15, 10}
      }
    },
    /* b */
    {
      4,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 10},
	{15, 10, 00, 10}
      }
    },
    /* c */
    {
      3,
      {
	{15, 00, 00, 00},
	{00, 00, 00, 20},
	{00, 20, 15, 20}
      }
    },
    /* d */
    {
      4,
      {
	{15, 00, 15, 20},
	{15, 20, 00, 20},
	{00, 20, 00, 10},
	{00, 10, 15, 10}
      }
    },
    /* e */
    {
      4,
      {
	{00, 00, 00, 20},
	{00, 00, 15, 00},
	{00, 10, 15, 10},
	{00, 20, 15, 20}
      }
    },
    /* f */
    {
      4,
      {
	{00, 00, 00, 20},
	{00, 00, 15, 00},
	{00, 10, 15, 10}
      }
    },
    /* g */
    {
      5,
      {
	{15, 00, 00, 00},
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 10},
	{15, 10,  5, 10}
      }
    },
    /* h */
    {
      3,
      {
	{00, 00, 00, 20},
	{15, 00, 15, 20},
	{00, 10, 15, 10}
      }
    },
    /* i */
    {
      3,
      {
	{10, 00, 10, 20},
	{ 5, 00, 15, 00},
	{ 5, 20, 15, 20}
      }
    },
    /* j */
    {
      4,
      {
	{10, 00, 10, 15},
	{ 5, 00, 10, 00},
	{ 5, 20,  8, 20},
	{ 8, 20, 10, 15}
      }
    },
    /* k */
    {
      3,
      {
	{00, 00, 00, 20},
	{00, 10, 15, 00},
	{00, 10, 15, 20}
      }
    },
    /* l */
    {
      2,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20}
      }
    },
    /* m */
    {
      4,
      {
	{00, 00, 00, 20},
	{15, 00, 15, 20},
	{00, 00, 10, 20},
	{10, 20, 15, 00},
      }
    },
    /* n */
    {
      3,
      {
	{00, 00, 00, 20},
	{15, 00, 15, 20},
	{00, 00, 15, 20}
      }
    },
    /* o */
    {
      4,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 00},
	{15, 00, 00, 00}
      }
    },
    /* p */
    {
      4,
      {
	{00, 00, 00, 20},
	{00, 00, 15, 00},
	{15, 00, 15, 10},
	{15, 10, 00, 10}
      }
    },
    /* q */
    {
      5,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 00},
	{15, 00, 00, 20},
	{10, 10, 20, 20}
      }
    },
    /* r */
    {
      5,
      {
	{00, 00, 00, 20},
	{00, 00, 15, 00},
	{15, 00, 15, 10},
	{15, 10, 00, 10},
	{10, 10, 20, 20}
      }
    },
    /* s */
    {
      5,
      {
	{00, 00, 15, 00},
	{00, 10, 15, 10},
	{00, 20, 15, 20},
	{00, 00, 00, 10},
	{15, 10, 15, 20}
      }
    },
    /* t */
    {
      2,
      {
	{10, 00, 10, 20},
	{ 5, 00, 15, 00}
      }
    },
    /* u */
    {
      3,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 00}
      }
    },
    /* v */
    {
      2,
      {
	{00, 00, 10, 20},
	{10, 20, 15, 00}
      }
    },
    /* w */
    {
      4,
      {
	{00, 00, 00, 20},
	{15, 00, 15, 20},
	{00, 20, 10, 00},
	{10, 00, 15, 20}
      }
    },
    /* x */
    {
      2,
      {
	{00, 00, 15, 20},
	{00, 20, 15, 00}
      }
    },
    /* y */
    {
      3,
      {
	{00, 00, 10, 10},
	{10, 10, 15, 00},
	{10, 10, 10, 20}
      }
    },
    /* z */
    {
      3,
      {
	{00, 00, 15, 00},
	{00, 20, 15, 20},
	{15, 00, 00, 20}
      }
    },
    /* 0 */
    {
      5,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 00},
	{15, 00, 00, 00},
	{00, 20, 15, 00}
      }
    },
    /* 1 */
    {
      2,
      {
	{00,  5, 10, 00},
	{10, 00, 10, 20},
      }
    },
    /* 2 */
    {
      4,
      {
	{00,  5, 10, 00},
	{10, 00, 15,  5},
	{15,  5, 00, 20},
	{00, 20, 15, 20}
      }
    },
    /* 3 */
    {
      4,
      {
	{15, 00, 15, 20},
	{00, 00, 15, 00},
	{00, 10, 15, 10},
	{00, 20, 15, 20}
      }
    },
    /* 4 */
    {
      3,
      {
	{10, 20, 10, 00},
	{10, 00, 00, 15},
	{00, 15, 15, 15}
      }
    },
    /* 5 */
    {
      5,
      {
	{00, 00, 15, 00},
	{00, 10, 15, 10},
	{00, 20, 15, 20},
	{00, 00, 00, 10},
	{15, 10, 15, 20}
      }
    },
    /* 6 */
    {
      5,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 10},
	{15, 10, 00, 10},
	{00, 00, 15, 00}
      }
    },
    /* 7 */
    {
      2,
      {
	{00, 00, 15, 00},
	{15, 00, 00, 20}
      }
    },
    /* 8 */
    {
      5,
      {
	{00, 00, 00, 20},
	{00, 20, 15, 20},
	{15, 20, 15, 00},
	{15, 00, 00, 00},
	{00, 10, 15, 10}
      }
    },
    /* 9 */
    {
      5,
      {
	{00, 00, 00, 10},
	{00, 20, 15, 20},
	{15, 20, 15, 00},
	{15, 00, 00, 00},
	{00, 10, 15, 10}
      }
    },
    /* l */
    {
      2,
      {
	{10, 00, 10, 15},
	{10, 17, 10, 20}
      }
    }
  };

void			load_string(t_fletters		*f,
				    const char		*str)
{
  int			c;
  int			i;
  int			j;

  int			midx;

  f->len = strlen(str);
  f->letters = bunny_malloc(sizeof(*f->letters) * f->len);
  midx = (f->len * 50);

  for (i = 0; i < f->len; ++i)
    {
      if (str[i] >= 'a' && str[i] <= 'z')
	c = str[i] - 'a';
      else if (str[i] >= '0' && str[i] <= '9')
	c = str[i] - '0' + 26;
      else if (str[i] != ' ')
	c = 36;
      else
	c = -1;

      if (c != -1)
	{
	  f->letters[i].cnt = gl_letters[c].cnt;
	  for (j = 0; j < gl_letters[c].cnt; ++j)
	    {
	      f->letters[i].coord[j].a[0] = gl_letters[c].line[j].x0 * 2 + i * 50 - midx / 2;
	      f->letters[i].coord[j].a[1] = gl_letters[c].line[j].y0 * 2 * 2 - 40;
	      f->letters[i].coord[j].a[2] = 0;

	      f->letters[i].coord[j].b[0] = gl_letters[c].line[j].x1 * 2 + i * 50 - midx / 2;
	      f->letters[i].coord[j].b[1] = gl_letters[c].line[j].y1 * 2 * 2 - 40;
	      f->letters[i].coord[j].b[2] = 0;
	    }
	}
      else
	f->letters[i].cnt = 0;
    }
}

